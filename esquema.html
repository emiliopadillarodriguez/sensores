<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Esquema sala de calderas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{
      --bg:#020617;
      --panel:#020617;
      --fg:#e5e7eb;
      --line:#1e293b;
    }

    body{
      margin:0;
      font-family: system-ui, Arial, sans-serif;
      background: var(--bg);
      color: var(--fg);
    }

    header{
      position: sticky;
      top: 0;
      z-index: 10;
      background: #020617;
      border-bottom: 1px solid var(--line);
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    header b{
      font-size: 14px;
    }

    button{
      padding: 6px 10px;
      font-size: 13px;
      border: 1px solid var(--line);
      border-radius: 8px;
      background: #020617;
      color: var(--fg);
      cursor: pointer;
    }

    button:hover{
      background: #0b1220;
    }

    #status{
      margin-left: auto;
      font-size: 12px;
      color: #94a3b8;
    }

    /* CONTENEDOR CON SCROLL */
    #viewer{
      width: 100vw;
      height: calc(100vh - 48px);
      overflow: auto;
      background: #000;
    }

    /* SVG */
    #viewer img{
      display: block;
      max-width: none;
      height: auto;
      transform-origin: top left;

      /* ⭐ CLAVE: invertir colores del SVG */
      filter: invert(1) brightness(1.15) contrast(1.1);
    }
  </style>
</head>

<body>

<header>
  <b>Esquema BMS · Sala de Calderas</b>

  <button onclick="zoomIn()">Zoom +</button>
  <button onclick="zoomOut()">Zoom −</button>
  <button onclick="resetZoom()">Ajustar</button>

  <span id="status">Cargando…</span>
</header>

<div id="viewer">
  <img id="svgImg" alt="Esquema">
</div>

<script>
  const img = document.getElementById("svgImg");
  const statusEl = document.getElementById("status");

  let scale = 1;

  function applyZoom(){
    img.style.transform = `scale(${scale})`;
    statusEl.textContent = `Zoom ${Math.round(scale * 100)}%`;
  }

  function zoomIn(){
    scale = Math.min(scale * 1.15, 6);
    applyZoom();
  }

  function zoomOut(){
    scale = Math.max(scale / 1.15, 0.15);
    applyZoom();
  }

  function resetZoom(){
    // Ajuste automático para ver el esquema completo
    const vw = viewer.clientWidth;
    const vh = viewer.clientHeight;
    const iw = img.naturalWidth;
    const ih = img.naturalHeight;

    if(iw && ih){
      scale = Math.min(vw / iw, vh / ih) * 0.97;
    }else{
      scale = 1;
    }
    applyZoom();
    viewer.scrollTop = 0;
    viewer.scrollLeft = 0;
  }

  // Cargar SVG (cache-bust)
  img.src = "esquema_render.svg?t=" + Date.now();

  img.onload = () => {
    statusEl.textContent = "SVG cargado";
    resetZoom();
  };

  img.onerror = () => {
    statusEl.textContent = "ERROR cargando esquema";
  };
</script>

</body>
</html>
